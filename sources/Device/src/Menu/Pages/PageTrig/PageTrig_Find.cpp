#include "defines.h"
#include "FPGA/FPGA_Settings.h"
#include "Menu/Pages/Include/PageTrig.h"
#include "Settings/Settings.h"


using namespace Osci::Settings;


extern const PageBase pageFind;


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
const PageBase *PageTrig::PageFind::pointer = &pageFind;


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static const char *hintsSearch_Mode[] = { "Ручной", "Hand", "Автоматический",  "Auto" };

static const ChoiceBase cMode =                                                                                                                               //--- СИНХР - ПОИСК - Режим ---
{
    Control::Type::Choice, 2, false, Page::Name::NoPage, &pageFind, Choice::FuncActive,
    {
        "Режим"
        ,
        "Выбор режима автоматического поиска синхронизации:\n"
        "1. \"Ручной\" - поиск производится по нажатию кнопки \"Найти\" или по удержанию в течение 0.5с кнопки СИНХР, если установлено "
        "\"СЕРВИС\x99Реж длит СИНХР\x99Автоуровень\".\n"
        "2. \"Автоматический\" - поиск производится автоматически."
    },
    (int8 *)&TRIG_MODE_FIND, // -V206
    hintsSearch_Mode, Choice::FuncChange, Choice::FuncDraw
};

//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
static void OnPress_Search()
{
    Osci::Settings::Trig::Level::Find();
}

DEF_BUTTON( bSearch,                                                                                                                                          //--- СИНХР - ПОИСК - Найти ---
    "Найти",
    "Производит поиск уровня синхронизации.",
    pageFind, Button::FuncActive, OnPress_Search, Choice::FuncDraw
)


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_PAGE_2( pageFind, // -V641 // -V1027                                                                                                                              //--- СИНХР - ПОИСК ---
    "ПОИСК",
    "Управление автоматическим поиском уровня синхронизации.",
    &cMode,                         ///< СИНХР - ПОИСК - Режим
    &bSearch,                       ///< СИНХР - ПОИСК - Найти
    Page::Name::Trig_Search, PageTrig::pointer, 0, Page::FuncPress, Page::FuncDraw, FuncRegSetPage
)
